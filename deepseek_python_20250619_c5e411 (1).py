import dash
from dash import dcc, html, Input, Output
import plotly.express as px
import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
results_df = pd.read_excel("–¥–∞–Ω–Ω—ã–µ –ø–æ —Ä—ã–Ω–∫—É —Å—É—à–∏.xlsx", sheet_name="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã")
profile_df = pd.read_excel("–¥–∞–Ω–Ω—ã–µ –ø–æ —Ä—ã–Ω–∫—É —Å—É—à–∏.xlsx", sheet_name="–ø—Ä–æ—Ñ–∏–ª—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è")

# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–º–µ—Ä)
# –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
results_df = results_df.dropna(how='all')
profile_df = profile_df.dropna(how='all')

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Dash-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
app = dash.Dash(__name__)

app.layout = html.Div([
    html.H1("üìä –î–∞—à–±–æ—Ä–¥: –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ —Å—É—à–∏ –≤ –û–º—Å–∫–µ", style={'textAlign': 'center'}),
    
    # –í–∫–ª–∞–¥–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–æ–≤
    dcc.Tabs([
        # –í–∫–ª–∞–¥–∫–∞ 1: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞
        dcc.Tab(label='–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–∞', children=[
            html.Div([
                html.H3("–ß–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤"),
                dcc.Graph(
                    figure=px.bar(
                        results_df,
                        x='–ö–∞–∫ —á–∞—Å—Ç–æ –ø–æ—Å–µ—â–∞—é—Ç —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã',
                        y='–∫–æ–ª-–≤–æ',
                        title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –ø–æ—Å–µ—â–µ–Ω–∏–π'
                    )
                ),
                
                html.H3("–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã"),
                dcc.Graph(
                    figure=px.pie(
                        results_df,
                        names='–ö–∞–∫–∏–µ —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã –≤ –≥. –û–º—Å–∫ –∑–Ω–∞—é—Ç',
                        values='–∫–æ–ª-–≤–æ',
                        title='–ò–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤'
                    )
                ),
                
                html.H3("–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏"),
                dcc.Graph(
                    figure=px.histogram(
                        results_df,
                        x='–ù–∞ —Å–∫–æ–ª—å–∫–æ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω—ã —Å—É—à–∏-—Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å–µ—â–∞—é—Ç —á–∞—â–µ –≤—Å–µ–≥–æ',
                        y='–∫–æ–ª-–≤–æ',
                        title='–£—Ä–æ–≤–µ–Ω—å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏'
                    )
                )
            ])
        ]),
        
        # –í–∫–ª–∞–¥–∫–∞ 2: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
        dcc.Tab(label='–ü—Ä–æ—Ñ–∏–ª—å –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è', children=[
            html.Div([
                html.H3("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –∏ –ø–æ–ª—É"),
                dcc.Graph(
                    figure=px.histogram(
                        profile_df,
                        x='–≤–æ–∑—Ä–∞—Å—Ç',
                        color='–ø–æ–ª',
                        title='–î–µ–º–æ–≥—Ä–∞—Ñ–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π'
                    )
                ),
                
                html.H3("–õ—é–±–∏–º—ã–µ –≤–∏–¥—ã —Å—É—à–∏/—Ä–æ–ª–ª–æ–≤"),
                dcc.Graph(
                    figure=px.treemap(
                        profile_df,
                        path=['–ö–∞–∫–∏–µ —Å—É—à–∏\—Ä–æ–ª–ª—ã –ª—é–±—è—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ'],
                        title='–ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ –≤–∏–¥–∞–º —Ä–æ–ª–ª–æ–≤'
                    )
                ),
                
                html.H3("–î–æ—Ö–æ–¥ vs. –õ—é–±–∏–º—ã–µ —Ä–æ–ª–ª—ã"),
                dcc.Graph(
                    figure=px.scatter(
                        profile_df,
                        x='–¥–æ—Ö–æ–¥',
                        y='–ö–∞–∫–∏–µ —Å—É—à–∏\—Ä–æ–ª–ª—ã –ª—é–±—è—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ',
                        color='–ø–æ–ª',
                        title='–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –æ—Ç –¥–æ—Ö–æ–¥–∞'
                    )
                )
            ])
        ]),
        
        # –í–∫–ª–∞–¥–∫–∞ 3: –¶–µ–Ω–æ–≤—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
        dcc.Tab(label='–¶–µ–Ω–æ–≤—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è', children=[
            html.Div([
                html.H3("–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –ø–æ—Ä—Ü–∏—é (8 —à—Ç.)"),
                dcc.Graph(
                    figure=px.box(
                        results_df,
                        y='–í—ã—à–µ –∫–∞–∫–æ–π —Ü–µ–Ω—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–∏–æ–±—Ä–µ—Ç—É—Ç –ø–æ—Ä—Ü–∏—é —Å—É—à–∏/—Ä–æ–ª–ª–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –¥–æ—Ä–æ–≥–æ (8 —à—Ç., ¬´–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è¬ª)',
                        title='–í–µ—Ä—Ö–Ω–∏–π –ø–æ—Ä–æ–≥ —Ü–µ–Ω—ã'
                    )
                ),
                
                html.H3("–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Ü–µ–Ω–∞ –∑–∞ –ø–æ—Ä—Ü–∏—é"),
                dcc.Graph(
                    figure=px.violin(
                        results_df,
                        y='–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Ü–µ–Ω–∞ –∑–∞ –ø–æ—Ä—Ü–∏—é —Å—É—à–∏/—Ä–æ–ª–ª–æ–≤ (8 —à—Ç., ¬´–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è¬ª)',
                        title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã—Ö —Ü–µ–Ω'
                    )
                )
            ])
        ])
    ])
])

if __name__ == '__main__':
    app.run_server(debug=True)